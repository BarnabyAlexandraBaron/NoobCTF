# 数论学习

## Examples of positive definite forms

(前面又卡掉了一部分,过程没记录下来,这里直接记结果了)

任何判别式d=-3的正定二元二次式都与 $x^2+xy+y^2$ 同等。以及，n可被 $x^2+xy+y^2$ 原始表示，当且仅当d=-3模n是一个平方。

比如我们让n=某个素数p，当-3模p是平方时，p可被 $x^2+xy+y^2$ 表示，说明 $p\equiv 0,1\mod 3$ 。再仔细看一下，我们是不是能得到更简单的式子呢？如果x是偶数，我们就能把p写成 $4(\frac{x}{2})^2+2(\frac{x}{2})y+y^2=3(\frac{x}{2})^2+(\frac{x}{2}+y)^2=3x^2+y^2$  ；如果y是偶数，我们也能使用相同的步骤找到更简式子；如果两者都是奇数，我们还能变形为 $(x+y)^2+(x+y)(-y)+(-y)^2$ ，发现x+y是偶数了，又能使用刚才的步骤了。看来无论x和y是什么，能被 $x^2+xy+y^2$ 表示的n也能被 $3x^2+y^2$ 表示。

总结一下就能得到一条定理：质数p可被 $x^2+3y^2$ 表示，当且仅当 $p\equiv 0,1\mod 3$ 。

接下来是d=-4。推理与d=-3的情况差不多，得出a=1，b=0，最简式子为 $x^2+y^2$ 。根据二元二次式表示数的规律，得到来自费马的一条定理: 质数p可被 $x^2+y^2$ 表示，当且仅当 $p\equiv 1,2\mod 4$ 。

然后d=-7。复制粘贴d=-3的推导过程，得到a=1， $b=\pm 1$ ，于是有两个式子 $x^ 2+xy+2y^2$ 和 $x^2-xy+2y^2$ 。注意到 $x\rightarrow -x$ 就能转换式子，于是我们只看 $x^2+xy+2y^2$ 。质数p能被该式子表示的前提是-7模4n是平方。这个没有前面几个明显，借用一下二次互反律。要让 $(\frac{-7}{p})=1$ ，等于要让 $(\frac{p}{7})=1$ ，说明 $p\equiv 1,2,4\mod 7$ 。此时就能得出 $p=x^2+xy+2y^2$ ,当且仅当 $p\equiv 0,1,2,4$ 。

有没有感觉 $x^2+xy+2y^2$ 还是太繁琐了？能不能得到更简的式子呢？当然可以。如果我们要表示的p是奇数的话，y就只能是偶数。如果非要让y是奇数，原式就只能表达偶数了，结合p是质数的条件，p只能为2。既然y是偶数，我们就能把y除以2，原式可被写为 $(x+\frac{y}{2})^2+7(\frac{y}{2})^2$ 。也就是说，当p不等于2， $p=x^2+7y^2,p\equiv 0,1,2,4\mod 7$ 。

d=-8。梅开四度，得到a=1，b=0，简化式为 $x^2+2y^2$ 。如果式子可表示质数p，说明-8模4p是平方，即 $(\frac{-2}{p})=1\Leftrightarrow p\equiv 1,3\mod 8$ 。

d=-11。我都懒得写了，总之a=1， $b=\pm 1$ ，简化式为 $x^2+xy+3y^2$ 和 $x^2-xy+3y^2$ 。跟之前一样，划掉第二个式子， $x\rightarrow -x$ 即可转换。 $p=x^2+xy+3y^2$ 说明-11模4p是平方，即 $(\frac{-11}{p})=1,0$ ，二次互反律得 $(\frac{p}{11})=1,0$ ，最后得到 $p\equiv 0,1,4,9,5,3\mod 11$ 。

事情终于在d=-12时有些不一样了。还是之前的推理方式，但这次我们发现a可以等于1或者2。那就分类讨论吧，a=1时b=0，c=3，简化式为 $x^2+3y^2$ 。a=2时b能等于-2，0，2，简化式为 $2x^2+2xy+2y^2$ 。得出结论，任何d=-12的正定二元二次式都与两者中的一个等价。如果想用两者之一表示n，-12模4n必须是平方。至于怎么区分两者，其实之前的课已经看过了，一个永远表达偶数，一个时偶时奇。所以如果n是奇数， $p\equiv 0,1\mod 3$ ，则 $p=x^2+3y^2$ 。

## More examples of binary quadratic

上节课看了判别式较小的几个正定式子，这节课继续往后看较大的情况,还是那个 $ax^2+bxy+cy^2$ 。

d=-15，根据最简式的定义 $|b|\leq |a|\leq |c|$ ， $b^2-4ac=-15$ ，得到 $3a^2\leq |-15|$ ，a可能等于1或者2。当a=1时，b等于正负1，就有 $x^2+xy=4y^2$ 和 $x^2-xy+4y^2$ 。此处|a|=|b|，可以划去第二个。当a=2时，b等于正负1，就有 $2x^2+xy+2y^2$ 和 $2x^2-xy+2y^2$ 。因为|a|=|c|，可以划去第二个。那么质数p可被两者其一所原始表示的前提是-15模4p是平方，即 $(\frac{-15}{p})=1$ 。二次互反律得到 $(\frac{p}{15})=1,p\equiv 1,3,4,8\mod 15$ 。注意 $(\frac{p}{15})$ 是雅可比符号，结果等于1不一定是代表p模15是平方。需要排除p=3和5的情况，因为这俩整除15。

至于p到底被哪个原始表示，要从两个式子的特征入手。 $x^2+xy=4y^2$ 模3同余0和1； $2x^2+xy+2y^2$ 模3同余0和2。因此当 $p\equiv 1\mod 3$ 时， $p=x^2+xy=4y^2$ ,对应 $p\equiv 1,2,4,8\mod 15$ 中的1和4。另外一个式子自然在 $p\equiv 2\mod 3$ 时表示了，对应 $p\equiv 2,8\mod 15$ 的情况。

d=-16的情况与d=-4相似，d=-12与d=-3的那种相似。a=1，2，分类讨论。a=1时，b=0，简化式为 $x^2+4y^2$ 。a=2时，b可能等于0，2。但是b=2这种情况是不可能的，尝试计算判别式时会发现 $2^2-4\*2\*c=-16$ 这个c找不到合适的值。因此只能是b=0的情况，简化式为 $2x^2+2y^2$ 。所以p想被两者之一表示的条件为-1模4p是平方，即 $p\equiv 1,2\mod 4$ 。这时我们注意到，如果 $p\equiv 1\mod 4$ ，它就只能被 $x^2+4y^2$ 表示。这也不是一个新结果，因为之前学 $x^2+y^2$ 时就注意到x和y中必须有一个偶数，否则它们加起来就不是奇数了。假设y是偶数，就能把原式变形为 $x^2+4(\frac{y}{2})^2$ ，得到我们刚才学的内容。一般来说，当我们把某个判别式乘上一个平方时，这两个判别式的式子通常是相关的。

d=-20，a=1，2。当a=1时，b=0，最简式为 $x^2+5y^2$ 。当a=2时，b=0，2。b=0的情况不可能，故只能为2，最简式为 $2x^2+2xy+3y^2$ 。当-20模4n是平方时，n可被两者之一原始表示。 $(\frac{-20}{p})=1$ ，则 $(\frac{-5}{p})=1$ ，得到 $p\equiv 1,3,7,9\mod 20$ 。如果把两个式子分别模5，会发现 $x^2+5y^2\equiv 1,4\mod 5$ ，而 $2x^2+2xy+3y^2\equiv 2,3\mod 5$ 。告诉我们当 $p\equiv 1,9\mod 20$ 时，p由前者表示；当 $p\equiv 3,7\mod 20$ 时，p由后者表示。

p=-23，a=1，2。当a=1时，b等于正负1，负一的情况被划掉，剩下 $x^2+xy+6y^2$ 。当a=2时，b也等于正负1，但这次的两个式子 $2x^2+xy+3y^2$ 和 $2x^2-xy+3y^2$ improperly equivalent，意味着我们无法直接划掉，要将其算在内。p可被三者之一原式表示的必要条件是-23模4p是平方， $(\frac{-23}{p})=1$ 。之前我们可以通过同余将几种式子区别开来，然而这次不可以。看来不同判别式的最简式之间有一下几种情况：

1. 只有1个等价类。如d=-3，-4，-7...-19
2. 大于1个等价类，但是可以通过同余区分开来。如d=-15,-20。
3. 大于1个等价类，且无法进行区分。正是刚才看的d=-23。

当判别式的值越来越大，第三种情况会经常发生。那么接下来看一个判别式值较大却只有一种等价类的例子。

d=-163。a的取值范围为0< $a\leq 7$ 。相应的， $|b|\leq 7$ 。通过判别式 $b^2-4ac=-163$ 可以看出，b必须是奇数，还剩下1，3，5，7。变形一下得到 $ac=\frac{163+b^2}{4}$ ，代入不同的b求得可能值为41，43，47，53。这些数字都是质数， $|a|\leq |c|$ ，则a只能等于1，b也只能等于1，c就是41。唯一的简化式为 $x^2+xy+41y^2$ 。

## Examples of indefinite binary quadratic forms

这节课来看不定式。不定式的判别式 $d=b^2-4ac\geq 0$ ，我们可以用与证明确定式类似的方法来证明不定式的简化式数量有限。根据简化式的定义 $|b|\leq |a|\leq |c|(a\not ={0})$ ，则 $|b^2|\leq |ac|$ ，也有 $|4ac|\geq |b^2|$ 。 $b^2-4ac\geq 0$ 告诉我们 $ac\leq 0$ ，取绝对值就能变形为 $b^2+4|ac|=d$ ，最终得到 $4a^2\leq d$ 。a的取值是有限的，进而b的取值也是有限的 $(a\not ={0})$ ，最后简化式的数量是有限的。

判别式总是满足 $d\equiv 0,1\mod 4$ 。d=0的情况不是特别有趣，回忆 $ax^2+bx+c=0$ ，这种情况代表两个根都是有理数。 $ax^2+bxy+cy^2$ 可被分解为 $m(nx+ky)^2$ ，比如 $5(3x+4y)^2$ ，改变常数5就能得到无数个类似的式子，况且探寻某个数字乘上一个平方好像不是很有意义。

d=1也不是特别好玩。 $4a^2\leq d=1$ ，说明a=0。 $b^2-4ac=1$ ，说明b等于正负1。这样构造出来的式子是 $\pm xy+cy^2$ ，或者说xy。解决xy=n这类问题也很无趣。

d=4没有好到哪里去。 $4a^2\leq d=4$ ，推算出a=0或正负1。这就有3种情况， $\pm 2xy+cy^2,x^2-y^2,-x^2+y^2$ 。但是这些情况都可以被分解， $\pm 2xy+cy^2=\pm y(2x+cy),x^2-y^2=(x-y)(x+y)$ 。其实任何 $d=n^2$ 的简化式都是这样，可以被分解，今后可以跳过这些值了。

d=5时，根据 $4a^2\leq d=5$ 可以得出a=0或者正负1。又结合 $d=b^2-4ac=5$ ，看出b等于正负1且a=0的情况应该被舍去。排列组合几种可能，得到4种情况： 

$x^2+xy-y^2$<br>
$x^2-xy-y^2$<br>
$-x^2+xy-y^2$<br>
$-x^2-xy-y^2$

发现它们都是等价的。那么我们可以得出，任何判别式d=5的式子都与 $x^2+xy-y^2$ 等价。经验告诉我们，n可被这个式子原始表示的前提是5模4n是平方。让n等于质数p，我们就需要看5模4p是不是平方。注意到5模4是平方，那只用看5模p了。利用二次互反律，p=5或者 $p\equiv 1,4\mod 5$ 。

d=8时，a可能等于0或者正负1。 $b^2-4ac=8$ ，b是偶数且排除a=0的情况。有两种可能， $x^2-2y^2$ 和 $-x^2+2y^2$ 。其实两种是等价的（ $x^2-2y^2=-(x+2y)^2+2(y-x)^2$ ），等于说任何d=8的式子都与 $x^2-2y^2$ 等价。n可被这个式子原始表示的前提是8模4n是平方。让n等于质数p，则现在要求解 $(\frac{8}{p})=1$ ，得到 $p\equiv \pm 1\mod 8$ 。因此 $p=x^2-2y^2$ 这个方程可解的前提是p=2或者 $p\equiv \pm 1\mod 8$ 。

不定式和确定式有截然不同的特点。确定式中有时会得到两个最简式，不过只要|a|=|b|或者|a|=|c|，两者就是等价的，通过 $b=\rightarrow -b$ 转换。确定式表示数字的方式也是有限的。而不定式有多个等价的最简式，且表示数字的方式是无限的。