# fakezip

[题目地址](https://adworld.xctf.org.cn/challenges/details?hash=72d26bd2-13c5-11ed-9827-fa163e4fa633)

差点没做出来。之前依赖工具，还是自己动手操作一下才行。

附件是一个加密的zip。但是题目说fakezip，那就是假的加密zip。想到伪加密，用之前用的一个在线破解工具没用，只能自己搜一下全局加密位。

- ### 压缩源文件数据区
  > 50 4B 03 04：这是头文件标记（0x04034b50）
<br>14 00：解压文件所需 pkware 版本
<br>00 00：全局方式位标记（有无加密）
<br>08 00：压缩方式
<br>5A 7E：最后修改文件时间
<br>F7 46：最后修改文件日期
<br>16 B5 80 14：CRC-32校验（1480B516）
<br>19 00 00 00：压缩后尺寸（25）
<br>17 00 00 00：未压缩尺寸（23）
<br>07 00：文件名长度
<br>00 00：扩展记录长度

- ### 压缩源文件目录区：
  > 50 4B 01 02：目录中文件文件头标记(0x02014b50)
<br>3F 00：压缩使用的 pkware 版本
<br>14 00：解压文件所需 pkware 版本
<br>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）
<br>08 00：压缩方式
<br>5A 7E：最后修改文件时间
<br>F7 46：最后修改文件日期
<br>16 B5 80 14：CRC-32校验（1480B516）
<br>19 00 00 00：压缩后尺寸（25）
<br>17 00 00 00：未压缩尺寸（23）
<br>07 00：文件名长度
<br>24 00：扩展字段长度
<br>00 00：文件注释长度
<br>00 00：磁盘开始号
<br>00 00：内部文件属性
<br>20 00 00 00：外部文件属性
<br>00 00 00 00：局部头部偏移量

看看手上的zip。

![fakezip](../../images/fakezip.png)

第三行从右往左数第三个字节应该是全局加密标志位。00为没有加密，01为加密。改成00再保存直接就是文件夹了。里面有张图片。就是flag。

- ### Flag
  > flag{39281de6-fe64-11ea-adc1-0242ac120002}